# Milestone v1.0: TUI Enhancements

**Status:** SHIPPED 2026-01-21
**Phases:** 1-5
**Total Plans:** 15

## Overview

Add clipboard support, scrolling, mouse interaction, priority system, Claude Code plugin configuration, and automatic self-upgrade to to-tui. These enhancements make the TUI more complete and user-friendly.

## Phases

### Phase 1: Clipboard Support

**Goal**: User can copy todo text to system clipboard with `y` key
**Depends on**: Nothing (first phase)
**Requirements**: CLIP-01, CLIP-02, CLIP-03, CLIP-04
**Plans**: 2 plans

Plans:
- [x] 01-01: Add arboard dependency and clipboard module (Wave 1)
- [x] 01-02: Implement copy action and keybinding (Wave 2)

**Completed:** 2026-01-17

### Phase 2: Scrolling & Mouse Support

**Goal**: Enable scrolling when content exceeds viewable area vertically, plus mouse interaction support
**Depends on**: Phase 1
**Requirements**: SCROLL-01, SCROLL-02, SCROLL-03, SCROLL-04
**Plans**: 3 plans

Plans:
- [x] 02-01: Add ListState scroll tracking and StatefulWidget rendering (Wave 1)
- [x] 02-02: Mouse scroll wheel and click offset handling (Wave 2)
- [x] 02-03: Scroll position indicator in title bar (Wave 2)

**Completed:** 2026-01-17

### Phase 3: Todo Priority System

**Goal**: Enable priority levels (P0/P1/P2) for todos with visual indicators and sorting capability
**Depends on**: Phase 2
**Requirements**: PRIO-01, PRIO-02, PRIO-03, PRIO-04, PRIO-05
**Plans**: 4 plans

Plans:
- [x] 03-01: Priority data model - enum, TodoItem field, database & markdown persistence (Wave 1)
- [x] 03-02: Priority cycling keybinding - 'p' to cycle priority, 'P' for plugin menu (Wave 2)
- [x] 03-03: Priority visual display - colored badges in TUI (Wave 2)
- [x] 03-04: Sort by priority - 's' key to sort todos by priority level (Wave 3)

**Completed:** 2026-01-19

### Phase 4: Claude Code Plugin Configuration

**Goal**: Fix MCP server configuration to work with Claude Code's plugin/marketplace system
**Depends on**: Phase 3
**Requirements**: CONFIG-01, CONFIG-02, CONFIG-03
**Plans**: 3 plans

Plans:
- [x] 04-01: Update .mcp.json and plugin.json with portable paths and complete metadata (Wave 1)
- [x] 04-02: Verify marketplace.json and install-binary.sh consistency (Wave 1)
- [x] 04-03: Update README with correct Claude Code plugin installation commands (Wave 2)

**Completed:** 2026-01-20

### Phase 5: Automatic Self-Upgrade

**Goal**: When user accepts upgrade in the upgrade prompt modal, automatically download and install the new version
**Depends on**: Phase 4
**Requirements**: UPGRADE-01, UPGRADE-02, UPGRADE-03, UPGRADE-04
**Plans**: 3 plans

Plans:
- [x] 05-01: Add dependencies and create upgrade module with download infrastructure (Wave 1)
- [x] 05-02: Integrate sub-states into AppState and event handling (Wave 2)
- [x] 05-03: Complete UI rendering and binary replacement/restart (Wave 3)

**Completed:** 2026-01-21

---

## Milestone Summary

**Key Decisions:**
- Use `y` key (vim yank) for copy, not Ctrl-C (terminal interrupt conflicts)
- Use arboard crate with wayland-data-control feature for Linux support
- Use ratatui ListState for automatic scroll-to-cursor behavior
- Priority badge format [P0]/[P1]/[P2] with colored foreground
- Sort by root item priority, children inherit parent's position
- Use ${CLAUDE_PLUGIN_ROOT} variable for binary path portability
- Download raw binaries (GitHub releases are not archived)
- Use std::thread for download (TUI has no tokio runtime)
- Restore terminal before exec() to prevent cursor issues

**Issues Resolved:**
- Clipboard unavailable on Wayland without special feature flag
- Scroll position indicator needed centralized visible_item_count()
- Plugin keybinding conflict (moved from `p` to `P`)
- tokio::spawn panicked without runtime (switched to std::thread)
- exec() didn't run Drop handlers (added explicit terminal restore)

**Technical Debt:**
- None significant

---

*For current project status, see .planning/ROADMAP.md*
