---
phase: 04-claude-code-plugin-configuration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .mcp.json
  - .claude-plugin/plugin.json
autonomous: true

must_haves:
  truths:
    - "MCP server configuration uses portable paths that work after plugin installation"
    - "plugin.json contains complete metadata matching marketplace.json"
  artifacts:
    - path: ".mcp.json"
      provides: "MCP server configuration with portable path"
      contains: "${CLAUDE_PLUGIN_ROOT}"
    - path: ".claude-plugin/plugin.json"
      provides: "Plugin manifest with full metadata"
      contains: "version"
  key_links:
    - from: ".mcp.json"
      to: "target/release/totui-mcp"
      via: "${CLAUDE_PLUGIN_ROOT} variable expansion"
      pattern: "\\$\\{CLAUDE_PLUGIN_ROOT\\}"
---

<objective>
Update MCP server and plugin configuration files to use portable paths and complete metadata.

Purpose: Fix the hardcoded absolute path in `.mcp.json` that prevents the plugin from working when installed by other users. Also complete the plugin.json metadata to match marketplace.json.

Output: Updated configuration files that work with Claude Code's plugin system.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-claude-code-plugin-configuration/04-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update .mcp.json to use portable path</name>
  <files>.mcp.json</files>
  <action>
Replace the hardcoded absolute path with the `${CLAUDE_PLUGIN_ROOT}` variable.

Change from:
```json
{
  "totui-mcp": {
    "command": "/Users/gimmi/Documents/Sources/rust/to-tui/target/release/totui-mcp",
    "args": []
  }
}
```

To:
```json
{
  "totui-mcp": {
    "command": "${CLAUDE_PLUGIN_ROOT}/target/release/totui-mcp",
    "args": []
  }
}
```

This is the ONLY change needed. The `${CLAUDE_PLUGIN_ROOT}` variable is expanded by Claude Code to the plugin's installation directory.
  </action>
  <verify>File contains `${CLAUDE_PLUGIN_ROOT}` and NOT hardcoded `/Users/` path</verify>
  <done>.mcp.json uses portable path variable for binary location</done>
</task>

<task type="auto">
  <name>Task 2: Complete plugin.json metadata</name>
  <files>.claude-plugin/plugin.json</files>
  <action>
Update plugin.json to include all required metadata fields, matching marketplace.json where applicable.

Current plugin.json is minimal:
```json
{
  "name": "totui-mcp",
  "description": "MCP server for to-tui - terminal todo list manager with daily todos, hierarchical tasks, and rollover support",
  "author": {
    "name": "to-tui"
  }
}
```

Update to include version, repository, license, and keywords:
```json
{
  "name": "totui-mcp",
  "description": "MCP server for to-tui - terminal todo list manager with daily todos, hierarchical tasks, and rollover support",
  "version": "0.2.11",
  "author": {
    "name": "to-tui"
  },
  "repository": "https://github.com/grimurjonsson/to-tui",
  "license": "MIT",
  "keywords": ["todo", "task", "mcp", "productivity"]
}
```

Note: Do NOT add mcpServers inline here - the .mcp.json file at plugin root is the standard location per Anthropic docs.
  </action>
  <verify>plugin.json contains "version": "0.2.11", "repository", "license", and "keywords" fields</verify>
  <done>plugin.json has complete metadata matching project information</done>
</task>

</tasks>

<verification>
1. `.mcp.json` contains `${CLAUDE_PLUGIN_ROOT}` (not hardcoded path)
2. `.claude-plugin/plugin.json` contains version, repository, license, keywords
3. Version in plugin.json matches Cargo.toml (0.2.11)
</verification>

<success_criteria>
- .mcp.json uses `${CLAUDE_PLUGIN_ROOT}/target/release/totui-mcp` path
- plugin.json contains complete metadata: name, description, version, author, repository, license, keywords
- No hardcoded user-specific paths in configuration files
</success_criteria>

<output>
After completion, create `.planning/phases/04-claude-code-plugin-configuration/04-01-SUMMARY.md`
</output>
